<html>
<head>
	<link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css">
	<link rel="stylesheet" href="css/bootstrap.css">
	<link rel="stylesheet" href="css/bootstrap.theme.css">
	<link rel="stylesheet" href="css/dse.css">


	<script src="js/random.js"></script>
	<script src="js/d3.v3.min.js"></script>
	<script src="jquery.js"></script>
	<script src="js/jquery.js"></script>
	<script src="js/histograms.js"></script>
	<script type="text/javascript" src="js/sizer.js"></script>
	<script type="text/javascript" src="js/storageEngineRepresentation.js"></script>
	<script src="js/bootstrap.js"></script>
	<script src="js/angular.js"></script>
	<script src="js/dse.js"></script>


	<!--google analytics snipet-->
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-57322103-1', 'auto');
	  ga('send', 'pageview');
	</script>
	  
	<script type="text/javascript">
	  var nowVisibleTab = 0;
	</script>

	<meta charset="UTF-8">
	<meta name="description" content="Data Modeling Tool for Cassandra / DataStax Enterprise">
	<meta name="keywords" content="data, modeling, cassandra, stress, cassandra-stress, datastax, dse, datastax-enterprise, c*">
	<meta name="author" content="Sebastian Estevez & Antonios A. Chariton">

	<title>DataStax CQL Data Modeler</title>

</head>

<body ng-app="dseviz" ng-controller="dsevizc">
	
	<!-- Navigation Bar (Top of Page ) -->
	<nav class="navbar navbar-inverse">
	  <div class="container-fluid">
	    <div class="navbar-header">
	      <a class="navbar-brand" href="/">
	        <img alt="Brand" style="height: 20px;" src="images/opsc-logo.png">
	      </a>
		  <p class="navbar-text">DSE Demonstrations</p>
	    </div>
	  </div>
	</nav>
	
	
	<!-- Page Title -->
	<div class="row">
		<div class="col-xs-10 col-xs-offset-1">
			<h1>CQL Data Modeler</h1>
			<h1><small>Input your table definition</small></h1>
			
			<p class="justified">
				This tool is meant to improve your experience with Apache 
				Cassandra and DSE by analyzing your data model. By providing 
				some information about your table definition, its volume, 
				and distribution, we can provide you with a script to 
				benchmark your data model and some diagnostics to improve it.
			</p>
			<p class="justified">
				Please input your table definition for one table, keeping 
				the Create statement, field definitions, and Primary Key 
				definition on separate lines.
			</p>
		</div>
	</div>
	
	<!-- Table creation query text area -->
	<div class="row">
		<div class="col-xs-10 col-xs-offset-1">
<textarea class="form-control" rows="10" id="createq">CREATE TABLE reviews_by_day
(
userid text,
day int,
productid text,
reviewid uuid,
profilename text,
helpfulness text,
score text,
summary text,
review text,
time timestamp,
PRIMARY KEY (userid, productid, time, reviewid)
)</textarea>
			<hr>
			<button type="submit" class="btn btn-default col-xs-12" ng-click="calculateTable()">Calculate Table</button>
		</div>
	</div>
	
	<!-- Separator between query textarea and tabs -->
	
	<div class="row">
		<div class="col-xs-10 col-xs-offset-1">
			<hr>
		</div>
	</div>
	
	<!-- Tabs -->
	
	<div class="row">
		<div class="col-xs-10 col-xs-offset-1">
			<ul class="nav nav-tabs">
			  <li role="presentation" ng-class="{'active':(nowVisibleTab==0)}" ng-click="nowVisibleTab = 0"><a href="">Storage Engine Visualization</a></li>
			  <li role="presentation" ng-class="{'active':(nowVisibleTab==1)}" ng-click="nowVisibleTab = 1"><a href="">Configuration</a></li>
			  <li role="presentation" ng-class="{'active':(nowVisibleTab==2)}" ng-click="nowVisibleTab = 2"><a href="">Test and Diagnosis</a></li>
			</ul>
		</div>
	</div>
		
	<!-- First tab (Visualization) -->
		
	<div class="row" id="storeng" ng-show="(nowVisibleTab == 0)">
		<div class="col-xs-10 col-xs-offset-1 well">
			<table class="table table-hover table-condensed table-bordered">
				<tr>
					<th class="text-center">Partition Key</th>
					<th></th>
				</tr>
				<tr>
					<th class="text-center">&lt;{{ partitionKey }}&gt;</th>
					<td>
						<table class="table table-hover table-condensed table-bordered">
							<tr>
								<th ng-repeat="dat in remainingFields" class="text-center">
									<span ng-repeat="clust in clusterKeys">
										&lt;{{ clust }}&gt;:
									</span>
									{{ dat }}
								</th>
							</tr>
							<tr>
								<td ng-repeat="dat in remainingFields" class="text-center">
									&lt;{{ dat }}&gt;
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
	</div>
	
	<!-- Second tab (Configuration) -->
	
	<div class="row" id="conf" ng-show="(nowVisibleTab == 1)">
		<div class="col-xs-10 col-xs-offset-1 well">
			<p class="justified">
				In order to generate a cassandra-stress yaml and provide 
				diagnostic information about your data model we need some 
				characteristics about your data.
			</p>
			<p class="justified">
				Please let us know how big your fields will be (size 
				distribution) and how frequently values appear (population 
				distribution).
			</p>
			
			<form method="get" action="#">
				<div class="form-group">
					<label for="NumberOfRows">Number of Rows:</label>
					<input type="text" class="form-control" id="NumberOfRows" placeholder="5000">
				</div>
				<div ng-repeat="field in tableFields">
					<div class="row">
						<div class="col-xs-12">
							<hr>
							<label for="LabelOf{{ field }}s"><em>Size</em> information for <em>{{ field }}</em>:</label>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-3">
							<div class="dropdown">
								<button class="btn btn-default dropdown-toggle" type="button" id="{{ field }}sizedist" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
									Distribution
									<span class="caret"></span>
								</button>
								<ul class="dropdown-menu" aria-labelledby="{{ field }}sizedistm">
									<li><a href="#">Normal</a></li>
									<li><a href="#">Fixed</a></li>
									<li><a href="#">Uniform</a></li>
									<li><a href="#">Exponential</a></li>
									<li><a href="#">Extreme</a></li>
								</ul>
							</div>
						</div>
						<div class="col-xs-4 col-xs-offset-1">
							<input type="text" class="form-control" id="mins{{ field }}" placeholder="Min size (bytes)">
						</div>
						<div class="col-xs-4">
							<input type="text" class="form-control col-xs-5" id="maxs{{ field }}" placeholder="Max size (bytes)">
						</div>
					</div>
					<div class="row">
						<div class="col-xs-12">
							<label for="LabelOf{{ field }}p"><em>Population</em> information for <em>{{ field }}</em>:</label>
						</div>
					</div>
					<div class="row">
						<div class="col-xs-3">
							<div class="dropdown">
								<button class="btn btn-default dropdown-toggle" type="button" id="{{ field }}popdist" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
									Distribution
									<span class="caret"></span>
								</button>
								<ul class="dropdown-menu" aria-labelledby="{{ field }}popdistm">
									<li><a href="#">Normal</a></li>
									<li><a href="#">Fixed</a></li>
									<li><a href="#">Uniform</a></li>
									<li><a href="#">Exponential</a></li>
									<li><a href="#">Extreme</a></li>
								</ul>
							</div>
						</div>
						<div class="col-xs-4 col-xs-offset-1">
							<input type="text" class="form-control" id="minp{{ field }}" placeholder="Min size (bytes)">
						</div>
						<div class="col-xs-4">
							<input type="text" class="form-control col-xs-5" id="maxp{{ field }}" placeholder="Max size (bytes)">
						</div>
					</div>
				</div>
			</form>
		</div>
	</div>
	
	<!-- Third tab (Test & Diagnosis) -->
	
	<div class="row" id="testdiag" ng-show="(nowVisibleTab == 2)">
		<div class="col-xs-10 col-xs-offset-1 well">
			<b>Likely SELECT queries for this data model:
			<table class="table table-hover table-condensed">
				<tr>
					<td>SELECT * FROM reviews_by_day WHERE userid = ?;</td>
				</tr>
				<tr>
					<td>SELECT * FROM reviews_by_day WHERE userid = ? AND productid = ?;</td>
				</tr>
				<tr>
					<td>SELECT * FROM reviews_by_day WHERE userid = ? AND productid = ? AND time = ?;</td>
				</tr>
				<tr>
					<td>SELECT * FROM reviews_by_day WHERE userid = ? AND productid = ? AND time = ? AND reviewid = ?;</td>
				</tr>
			</table>
			<div>
				<button type="button" class="btn btn-default col-xs-12 col-md-8 col-md-offset-2">Generate Cassandra Stresser 2.1 YAML</button>
			</div>
		</div>
	</div>
	
	<!-- Footer with copyright and link to source -->
	
	<div class="row">
		<div class="text-center">
			<p>&copy; 2015-2016 Antonios A. Chariton and Sebasti&aacute;n Est&eacute;vez</p>
			<p>Apache License v2.0 - Code on <a href="https://github.com/daknob/CassandraDataModeler">GitHub</a></p>
		</div>
	</div>
	
</body>
